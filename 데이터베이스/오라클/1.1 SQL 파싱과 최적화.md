# [친절한 SQL 튜닝] 1장. SQL 처리 과정과 I/O - 1.1 SQL 파싱과 최적화

# 1.1 SQL 파싱과 최적화

## 1.1.1 구조적, 집합적, 선언적 질의 언어

SQL은 구조적 집합적 선언적인 질의 언어다.

결과집합을 만드는 과정은 절차적이다. 즉, 프로시저가 필요하다

옵티마이저가 프로시저를 만드는 DBMS 내부 엔진이다. 프로그래밍을 대신해주는 셈이다. 

SQL 최적화 : DBMS 내부에서 프로시저를 작성하고 컴파일해서 실행 가능한 상태로 만드는 전 과정

## 1.1.2 SQL 최적화

최적화 과정 세분화

1. SQL 파싱 
    - 파싱 트리 생성 : SQL 문을 이루는 개별 구성요소를 분석해서 파싱 트리 생성
    - Systax 생성 : 문법적 오류가 없는지 확인
    - Semantic 체크 : 의미상 오류가 없는지 확인. ex) 존재하지 않는 테이블 또는 컬럼 사용, 사용한 오브젝트에 대한 권한이 있는지 확인

2. SQL 최적화

    옵티마이저가 이 역할을 맡는다.

    옵티마이저는 데이터베이스 성능을 결정하는 가장 핵심적인 엔진이다. 

3. 로우 소스 생성 

    로우 소스 생성기가 SQL 옵티마이저가 선택한 실행 경로를 실제 실행 가능한 코드 or 프로시저 형태로 포맷팅하는 단계 

## 1.1.3 SQL 옵티마이저

옵티마이저의 최적화 단계

1. 사용자가 전달한 쿼리를 수행하는 데 후보군이 될만한 실행계획 찾기
2. 데이터 딕셔너리에 미리 수집해 둔 오브젝트 통계 및 시스템 통계정보를 이용해 각 실행계획의 예상비용 산정 
3. 최저 비용을 나타내는 실행계획 선택 

*옵티마이저 / SQL 파서 / 로우 생성기 모두 백그라운드 프로세스 X . 서버 프로세스가 가진 기능.

## 1.1.4 실행계획과 비용

실행계획 : SQL 실행 경로 미리보기.

미리보기를 통해 

- 테이블 스캔 or 인덱스 스캔
- 인덱스 스캔시 어떤 인덱스인지
- 실행경로 변경

가능 

비용 : 쿼리 수행동안 발생할 것으로 예상하는 I/O 횟수, 예상 소요 시간 

## 1.1.5 옵티마이저 힌트

힌트를 통해서 데이터 액세스 경로를 바꿀 수 있다. 

*주의사항 

힌트와 힌트 사이 ',' 사용 X 

테이블 지정시 스키마명 명시 X

FROM 절에 ALIAS를 지정했다면, 힌트에도 ALIAS 사용필수